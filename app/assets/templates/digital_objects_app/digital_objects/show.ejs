<%
  //Passed params:
  //
  //digitalObject
  //previousSearchResultPid (may be null)
  //nextSearchResultPid (may be null)
  //totalNumSearchResults (may be null)
%>
<% if(Hyacinth.DigitalObjectsApp.currentSearchParams == null) { %>
  <% Hyacinth.ContextualNav.setNavTitle('&laquo; Digital Objects', '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'index'})) %>
<% } else { %>
  <% Hyacinth.ContextualNav.setNavTitle('&laquo; Back To Search', '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'index', search: Hyacinth.DigitalObjectsApp.currentSearchParams})) %>
<% } %>

<%

var navItems = [];

if (digitalObject.digital_object_type.string_key == 'item') {
  if (digitalObject.getOrderedChildDigitalObjectPids().length > 0) {
    navItems.push({label: 'Manage Child Assets', url: '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'manage_children', pid: Hyacinth.DigitalObjectsApp.params['pid']})});
  }
  navItems.push({label: 'New Child Asset', url: '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'upload_assets', parent_digital_object_pid: Hyacinth.DigitalObjectsApp.params['pid']})});
} else if (digitalObject.digital_object_type.string_key == 'group') {
  if (digitalObject.getOrderedChildDigitalObjectPids().length > 0) {
    navItems.push({label: 'Manage Children', url: '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'manage_children', pid: Hyacinth.DigitalObjectsApp.params['pid']})});
  }
  navItems.push({label: 'New Child', url: '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'new_setup', project_string_key: digitalObject.getProjects()[0]['string_key'], parent_digital_object_pid: Hyacinth.DigitalObjectsApp.params['pid']})});
}

navItems.push({label: 'Edit', url: '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'edit', pid: Hyacinth.DigitalObjectsApp.params['pid']})});

%>
<% Hyacinth.ContextualNav.setNavItems(navItems); %>

<%
if (typeof(Hyacinth.DigitalObjectsApp.params['searchResultNumber']) != 'undefined' && (previousSearchResultPid || nextSearchResultPid)) {
  var searchResultNumber = parseInt(Hyacinth.DigitalObjectsApp.params['searchResultNumber']);
  %>
  <div class="result-count-and-sort-options">
    <div class="row">
      <div class="col-md-8">
        <%
        if (totalNumSearchResults) {
          %><small><%= (searchResultNumber + 1) + ' of ' + totalNumSearchResults %></small><%
        }
        %>
      </div>
      <div class="col-md-4 alignright">
        <%
        if(previousSearchResultPid) {
          %><a class="btn btn-default btn-xs" href="<%= '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'show', pid: previousSearchResultPid, searchResultNumber: searchResultNumber - 1}) %>"><span class="glyphicon glyphicon-backward"></span></a><%
        } else {
          %><a class="disabled btn btn-default btn-xs"><span class="glyphicon glyphicon-backward"></span></a><%
        }
        %>

        <%
        if(nextSearchResultPid) {
          %><a class="btn btn-default btn-xs" href="<%= '#' + Hyacinth.DigitalObjectsApp.paramsToHashValue({controller: 'digital_objects', action: 'show', pid: nextSearchResultPid, searchResultNumber: searchResultNumber +1}) %>"><span class="glyphicon glyphicon-forward"></span></a><%
        } else {
          %><a class="disabled btn btn-default btn-xs"><span class="glyphicon glyphicon-forward"></span></a><%
        }
        %>
      </div>
      <div class="clearfix"></div>
    </div>
  </div>
  <%
}
%>

<div id="digital-object-editor"></div>
